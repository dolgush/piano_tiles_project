//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "Unit3.h"
#include "Unit1.h"
#include "Unit2.h"
#include "cmath"
#include <mmsystem.h>
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm1 *Form1;
Graphics::TBitmap  *kadr = new Graphics::TBitmap(),
					*kadr2 = new Graphics::TBitmap(),
				   *fon = new Graphics::TBitmap(),
				   *fon_kadr1 = new Graphics::TBitmap(),
				   *fon_kadr2 = new Graphics::TBitmap(),
				   *fon_kadr3 = new Graphics::TBitmap(),
				   *fon_kadr4 = new Graphics::TBitmap(),
				   *fon_kadr5 = new Graphics::TBitmap(),
				   *fon_kadr6 = new Graphics::TBitmap(),
				   *fon_kadr7 = new Graphics::TBitmap(),
				   *fon_kadr8 = new Graphics::TBitmap(),
				   *fon_kadr9 = new Graphics::TBitmap(),
				   *fon_kadr10 = new Graphics::TBitmap(),
				   *fon_kadr11 = new Graphics::TBitmap(),
				   *fon_kadr12 = new Graphics::TBitmap(),
				   *fon_kadr13 = new Graphics::TBitmap(),
				   *fon_kadr14 = new Graphics::TBitmap(),
				   *fon_kadr15 = new Graphics::TBitmap(),
				   *fon_kadr16 = new Graphics::TBitmap(),
				   *fon_kadr17= new Graphics::TBitmap(),
				   *fon_kadr18 = new Graphics::TBitmap(),
				   *fon_kadr19 = new Graphics::TBitmap(),
				   *fon_kadr20 = new Graphics::TBitmap(),
				   *fon_kadr21 = new Graphics::TBitmap(),
				   *fon_kadr22 = new Graphics::TBitmap();
double w, h, x_line1=450, y_line1 = -875,y_line2 = -1025,y_line3 = -1175,
y_line4 = -1325,y_line5 = -1475,
y_line6 = -1625,y_line7 = -1775,
y_line8 = -1925,y_line9 = -2075,
y_line10 = -2225,y_line11 = -2375,
y_line12 = -2525,y_line13 = -2675,
y_line14 = -3525,y_line15 = -5675,
y_line16 = -4525,y_line17 = -6675,
x_line2=300,x_line3=450,x_line4=300,
x_line5=450,x_line6=0,x_line7=450,
x_line8=300,x_line9=150,x_line10=300,
x_line11=150,x_line12=450,x_line13=150;




double v0;
bool kost = true;
double u;
double i = 0;
int k1 = 81;
int k2 = 87;
int k3 = 69;
int k4 = 82;
int y = 0;
extern int theme;
extern int key;
extern int mode;
double t=0;
double k=0;
bool line1 = false;
bool line2 = false;
bool line3 = false;
bool line4 = false;
bool line5 = false;
bool line6 = false;
bool line7 = false;
bool line8 = false;
bool line9 = false;
bool line10 = false;
bool line11 = false;
bool line12 = false;
bool line13 = false;
bool line14 = false;
bool line15 = false;
bool line16 = false;
bool line17 = false;
bool line18 = false;
bool line19 = false;
bool line20 = false;
bool line21 = false;
bool line22 = false;
bool line23 = false;
bool line24 = false;
bool line25 = false;
bool line26 = false;
bool line27 = false;
bool line28 = false;

TRect pr_kadr, pr_fon1,pr_fon2,pr_fon3,pr_fon4,pr_fon5,pr_fon6,pr_fon7,pr_fon8,pr_fon9,
pr_fon10,pr_fon11,pr_fon12,pr_fon13,pr_fon14,pr_fon15;
//---------------------------------------------------------------------------
__fastcall TForm1::TForm1(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------
void __fastcall TForm1::Timer1Timer(TObject *Sender)
{
	y++;
	Image1 -> Canvas -> Draw (x_line1, y_line1, fon_kadr1);
	Image1 -> Canvas -> Draw (x_line2, y_line2, fon_kadr2);
	Image1 -> Canvas -> Draw (x_line3, y_line3, fon_kadr3);
	Image1 -> Canvas -> Draw (x_line4, y_line4, fon_kadr4);
	Image1 -> Canvas -> Draw (x_line5, y_line5, fon_kadr5);
	Image1 -> Canvas -> Draw (x_line6, y_line6, fon_kadr6);
	Image1 -> Canvas -> Draw (x_line7, y_line7, fon_kadr7);
	Image1 -> Canvas -> Draw (x_line8, y_line8, fon_kadr8);
	Image1 -> Canvas -> Draw (x_line9, y_line9, fon_kadr9);
	Image1 -> Canvas -> Draw (x_line10, y_line10, fon_kadr10);
	Image1 -> Canvas -> Draw (x_line11, y_line11, fon_kadr11);
	Image1 -> Canvas -> Draw (x_line12, y_line12, fon_kadr12);
	Image1 -> Canvas -> Draw (x_line13, y_line13, fon_kadr13);
	y_line2 += 7.6;
	y_line1 += 7.6;
	y_line3 +=7.6;
	y_line4 += 7.6;
	y_line5 += 7.6;
	y_line6 += 7.6;
	y_line7 += 7.6;
	y_line8 += 7.6;
	y_line9 += 7.6;
	y_line10 += 7.6;
	y_line11 += 7.6;
	y_line12 += 7.6;
	y_line13 += 7.6;
	Label1 -> Caption = y;
	if (line2 == true)
	{
		pr_fon2 = Bounds(x_line2, y_line2, w, h);
		fon_kadr2 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon2);
		Image1 -> Canvas -> Draw(x_line2, y_line2, kadr2);
	}
	else
	{
	 pr_fon2 = Bounds(x_line2, y_line2, w, h);
	 fon_kadr2 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon2);
	 Image1 -> Canvas -> Draw(x_line2, y_line2, kadr);
	}
	if (line1 == true)
	{
		pr_fon1 = Bounds(x_line1, y_line1, w, h);
		fon_kadr1 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon1);
		Image1 -> Canvas -> Draw(x_line1, y_line1, kadr2);
	}
	else
	{
	 pr_fon1 = Bounds(x_line1, y_line1, w, h);
	 fon_kadr1 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon1);
	 Image1 -> Canvas -> Draw(x_line1, y_line1, kadr);
	}
	if (line3 == true)
	{
		pr_fon3 = Bounds(x_line3, y_line3, w, h);
		fon_kadr3 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon3);
		Image1 -> Canvas -> Draw(x_line3, y_line3, kadr2);
	}
	else
	{
	 pr_fon3 = Bounds(x_line3, y_line3, w, h);
	 fon_kadr3 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon3);
	 Image1 -> Canvas -> Draw(x_line3, y_line3, kadr);
	}
	if (line4 == true)
	{
		pr_fon4 = Bounds(x_line4, y_line4, w, h);
		fon_kadr4 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon4);
		Image1 -> Canvas -> Draw(x_line4, y_line4, kadr2);
	}
	else
	{
	 pr_fon4 = Bounds(x_line4, y_line4, w, h);
	 fon_kadr4 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon4);
	 Image1 -> Canvas -> Draw(x_line4, y_line4, kadr);
	}
	if (line5 == true)
	{
		pr_fon5 = Bounds(x_line5, y_line5, w, h);
		fon_kadr5 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon5);
		Image1 -> Canvas -> Draw(x_line5, y_line5, kadr2);
	}
	else
	{
	 pr_fon5 = Bounds(x_line5, y_line5, w, h);
	 fon_kadr5 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon5);
	 Image1 -> Canvas -> Draw(x_line5, y_line5, kadr);
	}
	if (line6 == true)
	{
		pr_fon6 = Bounds(x_line6, y_line6, w, h);
		fon_kadr6 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon6);
		Image1 -> Canvas -> Draw(x_line6, y_line6, kadr2);
	}
	else
	{
	 pr_fon6 = Bounds(x_line6, y_line6, w, h);
		fon_kadr6 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon6);
		Image1 -> Canvas -> Draw(x_line6, y_line6, kadr);
	}
	if (line7 == true)
	{
		pr_fon7 = Bounds(x_line7, y_line7, w, h);
		fon_kadr7 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon7);
		Image1 -> Canvas -> Draw(x_line7, y_line7, kadr2);
	}
	else
	{
	 pr_fon7 = Bounds(x_line7, y_line7, w, h);
		fon_kadr7 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon7);
		Image1 -> Canvas -> Draw(x_line7, y_line7, kadr);
	}
	if (line8 == true)
	{
		pr_fon8 = Bounds(x_line8, y_line8, w, h);
		fon_kadr8 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon8);
		Image1 -> Canvas -> Draw(x_line8, y_line8, kadr2);
	}
	else
	{
	 pr_fon8 = Bounds(x_line8, y_line8, w, h);
		fon_kadr8 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon8);
		Image1 -> Canvas -> Draw(x_line8, y_line8, kadr);
	}
	if (line9 == true)
	{
		pr_fon9 = Bounds(x_line9, y_line9, w, h);
		fon_kadr9 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon9);
		Image1 -> Canvas -> Draw(x_line9, y_line9, kadr2);
	}
	else
	{
	 pr_fon9 = Bounds(x_line9, y_line9, w, h);
		fon_kadr9 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon9);
		Image1 -> Canvas -> Draw(x_line9, y_line9, kadr);
	}
	if (line10 == true)
	{
		pr_fon10 = Bounds(x_line10, y_line10, w, h);
		fon_kadr10 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon10);
		Image1 -> Canvas -> Draw(x_line1, y_line10, kadr2);
	}
	else
	{
	 pr_fon10 = Bounds(x_line10, y_line10, w, h);
		fon_kadr10 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon10);
		Image1 -> Canvas -> Draw(x_line1, y_line10, kadr);
	}
	if (line11 == true)
	{
		pr_fon11 = Bounds(x_line11, y_line11, w, h);
		fon_kadr11 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon11);
		Image1 -> Canvas -> Draw(x_line11, y_line11, kadr2);
	}
	else
	{
	 pr_fon11 = Bounds(x_line11, y_line11, w, h);
		fon_kadr11 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon11);
		Image1 -> Canvas -> Draw(x_line11, y_line11, kadr);
	}
    if (line12 == true)
	{
		pr_fon12 = Bounds(x_line12, y_line12, w, h);
		fon_kadr12 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon12);
		Image1 -> Canvas -> Draw(x_line12, y_line12, kadr2);
	}
	else
	{
	 pr_fon12 = Bounds(x_line12, y_line12, w, h);
		fon_kadr12 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon12);
		Image1 -> Canvas -> Draw(x_line12, y_line12, kadr);
	}
	if (line13 == true)
	{
		pr_fon13 = Bounds(x_line13, y_line13, w, h);
		fon_kadr13 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon13);
		Image1 -> Canvas -> Draw(x_line13, y_line13, kadr2);
	}
	else
	{
	 pr_fon13 = Bounds(x_line13, y_line13, w, h);
		fon_kadr13 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon13);
		Image1 -> Canvas -> Draw(x_line13, y_line13, kadr);
	}

}
//---------------------------------------------------------------------------


void __fastcall TForm1::FormKeyDown(TObject *Sender, WORD &Key, TShiftState Shift)

{
	if(y_line1 >=500 && y_line1 <= 900 && Key == k4)
		line1 = true;
	if(y_line2 >=500 && y_line3 <= 900 && Key == k3)
		line2 = true;
	if(y_line3 >=500 && y_line4 <= 900 && Key == k4)
		line3 = true;
	if(y_line4 >=500 && y_line5 <= 900 && Key == k3)
		line4 = true;
	if(y_line5 >=500 && y_line6 <= 900 && Key == k4)
		line5 = true;
	if(y_line6 >=500 && y_line7 <= 900 && Key == k1)
		line6 = true;
	if(y_line7 >=500 && y_line8 <= 900 && Key == k4)
		line7 = true;
	if(y_line8 >=500 && y_line9 <= 900 && Key == k3)
		line8 = true;
	if(y_line9 >=500 && y_line10 <= 900 && Key == k2)
		line9 = true;
	if(y_line9 >=500 && y_line11 <= 900 && Key == k3)
		line9 = true;
	if(y_line10 >=500 && y_line12 <= 900 && Key == k2)
		line10 = true;
	if(y_line11 >=500 && y_line13 <= 900 && Key == k4)
		line11 = true;
	if(y_line12 >=500 && y_line14 <= 900 && Key == k2)
		line12 = true;
	if(y_line13 >=500 && y_line15 <= 900 && Key == k2)
		line13 = true;
	if(y_line14 >=500 && y_line16 <= 900 && Key == k2)
		line14 = true;
}
//---------------------------------------------------------------------------




void __fastcall TForm1::SpeedButton3Click(TObject *Sender)
{
	Timer1->Enabled = false;
	Form2->Show();
}
//---------------------------------------------------------------------------

void __fastcall TForm1::SpeedButton2Click(TObject *Sender)
{
   Timer1->Enabled = false;
}
//---------------------------------------------------------------------------

void __fastcall TForm1::SpeedButton1Click(TObject *Sender)
{
	PlaySoundA("D:\\sound.wav",NULL,SND_ASYNC);

	if (key == 1)
	{
		 k1 = 81;
		 k2 = 87;
		k3 = 69;
		k4 = 82;
	}
	if (key == 2)
	{
		 k1 = 49;
		 k2 = 50;
		k3 = 51;
		k4 = 52;
	}
	if (key == 3)
	{
		 k1 = 65;
		 k2 = 83;
		k3 = 68;
		k4 = 70;
	}
	SpeedButton2 -> Visible = true;
	SpeedButton3 -> Visible = true;
	SpeedButton4 -> Visible = true;
   Timer1->Enabled = true;
	if (theme == 1)
	{
		fon -> LoadFromFile("pole2.bmp");
	}
	if (theme == 2)
	{
		fon -> LoadFromFile("pole1.bmp");
	}
	if (theme == 3)
	{
		fon -> LoadFromFile("pole3.bmp");
	}
	Image1 -> Picture -> Assign(fon);
	if (theme == 1)
	{
		kadr -> LoadFromFile("kletka.bmp");
		kadr2 -> LoadFromFile("kletka2.bmp");
	}
	if (theme == 2)
	{
		kadr -> LoadFromFile("kletka.bmp");
		kadr2 -> LoadFromFile("kletka2.bmp");
	}
	if (theme == 3)
	{
		kadr -> LoadFromFile("kletka3.bmp");
		kadr2 -> LoadFromFile("kletka4.bmp");
	}
   w = kadr -> Width;
   h = kadr -> Height;
   fon_kadr1 -> Width = w;
   fon_kadr1 -> Height = h;
   fon_kadr2 -> Width = w;
   fon_kadr2 -> Height = h;
   fon_kadr3 -> Width = w;
   fon_kadr3 -> Height = h;
   fon_kadr4 -> Width = w;
   fon_kadr4 -> Height = h;
   fon_kadr5 -> Width = w;
   fon_kadr5 -> Height = h;
   fon_kadr6 -> Width = w;
   fon_kadr6 -> Height = h;
   fon_kadr7 -> Width = w;
   fon_kadr7 -> Height = h;
   fon_kadr8 -> Width = w;
   fon_kadr8 -> Height = h;
   fon_kadr9 -> Width = w;
   fon_kadr9 -> Height = h;
   fon_kadr10 -> Width = w;
   fon_kadr10 -> Height = h;
   fon_kadr11 -> Width = w;
   fon_kadr11 -> Height = h;
   fon_kadr12 -> Width = w;
   fon_kadr12 -> Height = h;
   fon_kadr13 -> Width = w;
   fon_kadr13 -> Height = h;
   pr_kadr = Bounds(0, 0, w, h);
   pr_fon1 = Bounds(x_line1, y_line1, w, h);
   pr_fon2 = Bounds(x_line2, y_line2, w, h);
   pr_fon3 = Bounds(x_line3, y_line3, w, h);
   pr_fon4 = Bounds(x_line4, y_line4, w, h);
   pr_fon5 = Bounds(x_line5, y_line5, w, h);
   pr_fon6 = Bounds(x_line6, y_line6, w, h);
   pr_fon7 = Bounds(x_line7, y_line7, w, h);
   pr_fon8 = Bounds(x_line8, y_line8, w, h);
   pr_fon9 = Bounds(x_line9, y_line9, w, h);
   pr_fon10 = Bounds(x_line10, y_line10, w, h);
   pr_fon11 = Bounds(x_line11, y_line11, w, h);
   pr_fon12 = Bounds(x_line12, y_line12, w, h);
   pr_fon13 = Bounds(x_line13, y_line13, w, h);
   fon_kadr1 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon1);
   fon_kadr2 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon2);
   fon_kadr3 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon3);
   fon_kadr4 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon4);
   fon_kadr5 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon5);
   fon_kadr6 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon6);
   fon_kadr7 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon7);
   fon_kadr8 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon8);
   fon_kadr9 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon9);
   fon_kadr10 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon10);
   fon_kadr11 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon11);
   fon_kadr12 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon12);
   fon_kadr13 -> Canvas -> CopyRect(pr_kadr, fon -> Canvas, pr_fon13);

}
//---------------------------------------------------------------------------

void __fastcall TForm1::SpeedButton4Click(TObject *Sender)
{
	Timer1->Enabled = false;
   x_line1=450, y_line1 = -875,y_line2 = -1025,y_line3 = -1175,
y_line4 = -1325,y_line5 = -1475,
y_line6 = -1625,y_line7 = -1775,
y_line8 = -1925,y_line9 = -2075,
y_line10 = -2225,y_line11 = -2375,
y_line12 = -2525,y_line13 = -2675,
y_line14 = -3525,y_line15 = -5675,
y_line16 = -4525,y_line17 = -6675,
x_line2=300,x_line3=450,x_line4=300,
x_line5=450,x_line6=0,x_line7=450,
x_line8=300,x_line9=150,x_line10=300,
x_line11=150,x_line12=450,x_line13=150;
}
//---------------------------------------------------------------------------

